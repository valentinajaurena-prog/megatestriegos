<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MegaTest PRL Almac√©n</title>
<style>
body{
font-family: Arial, sans-serif;
background: linear-gradient(135deg,#0f2027,#203a43,#2c5364);
color:white;
margin:0;
text-align:center;
}

h1{margin-top:20px;}

.container{
padding:20px;
max-width:600px;
margin:auto;
}

button{
padding:12px 20px;
margin:10px;
border:none;
border-radius:10px;
font-size:16px;
cursor:pointer;
background:#00c6ff;
color:black;
font-weight:bold;
}

button:hover{
background:#00a6d6;
}

.option{
display:block;
margin:10px auto;
padding:12px;
width:100%;
max-width:400px;
border-radius:8px;
background:white;
color:black;
cursor:pointer;
}

.correct{background:#4caf50 !important;color:white;}
.wrong{background:#e53935 !important;color:white;}

#timer{font-size:20px;margin:10px;}

.hidden{display:none;}

input{
padding:10px;
border-radius:8px;
border:none;
margin-top:10px;
}

.ranking{
text-align:left;
background:rgba(255,255,255,0.1);
padding:10px;
border-radius:10px;
margin-top:20px;
}
</style>
</head>
<body>

<div class="container">

<h1>üî• MegaTest PRL Almac√©n</h1>

<div id="menu">
<button onclick="startExam()">üìò Modo Examen (20 preguntas)</button>
<button onclick="startTime()">‚è±Ô∏è Reto 60 segundos</button>
<button onclick="showRanking()">üèÜ Ranking</button>
</div>

<div id="game" class="hidden">
<div id="timer"></div>
<h3 id="question"></h3>
<div id="options"></div>
</div>

<div id="result" class="hidden">
<h2 id="finalScore"></h2>
<input type="text" id="playerName" placeholder="Tu nombre">
<br>
<button onclick="saveScore()">Guardar puntuaci√≥n</button>
<button onclick="backToMenu()">Volver al men√∫</button>
</div>

<div id="ranking" class="hidden">
<h2>üèÜ Ranking</h2>
<div class="ranking" id="rankingList"></div>
<button onclick="backToMenu()">Volver</button>
</div>

</div>

<script>

// ==== BASE DE DATOS DE PREGUNTAS ====
// Aqu√≠ puedes pegar las 200+ preguntas
const questions = [
{q:"¬øQu√© es un EPI?",a:["Equipo Personal Individual","Equipo de Protecci√≥n Individual","Elemento Preventivo Interno"],correct:1},
{q:"Altura m√°xima segura sin protecci√≥n colectiva:",a:["2 metros","1 metro","5 metros"],correct:0},
{q:"El almacenamiento APQ significa:",a:["Almacenamiento Productos Qu√≠micos","Archivo Preventivo","√Årea Protecci√≥n Calidad"],correct:0},
];

// Para simular muchas:
for(let i=0;i<200;i++){
questions.push({
q:"Pregunta simulada n¬∫ "+(i+1),
a:["Opci√≥n A","Opci√≥n B","Opci√≥n C"],
correct:Math.floor(Math.random()*3)
});
}

let current=0;
let score=0;
let totalQuestions=20;
let timerInterval;
let timeLeft=60;
let mode="exam";
let selectedQuestions=[];

function shuffle(array){
return array.sort(()=>Math.random()-0.5);
}

function startExam(){
mode="exam";
totalQuestions=20;
selectedQuestions=shuffle([...questions]).slice(0,totalQuestions);
startGame();
}

function startTime(){
mode="time";
timeLeft=60;
score=0;
selectedQuestions=shuffle([...questions]);
startGame();
startTimer();
}

function startGame(){
document.getElementById("menu").classList.add("hidden");
document.getElementById("result").classList.add("hidden");
document.getElementById("ranking").classList.add("hidden");
document.getElementById("game").classList.remove("hidden");
current=0;
score=0;
showQuestion();
}

function showQuestion(){
if(mode==="exam" && current>=totalQuestions){
endGame();
return;
}
if(mode==="time" && timeLeft<=0){
endGame();
return;
}

let q=selectedQuestions[current];
document.getElementById("question").innerText=q.q;
let optionsDiv=document.getElementById("options");
optionsDiv.innerHTML="";

q.a.forEach((opt,i)=>{
let btn=document.createElement("button");
btn.innerText=opt;
btn.className="option";
btn.onclick=()=>checkAnswer(i);
optionsDiv.appendChild(btn);
});
}

function checkAnswer(index){
let correct=selectedQuestions[current].correct;
if(index===correct) score++;
current++;
showQuestion();
}

function startTimer(){
document.getElementById("timer").innerText="‚è≥ 60s";
timerInterval=setInterval(()=>{
timeLeft--;
document.getElementById("timer").innerText="‚è≥ "+timeLeft+"s";
if(timeLeft<=0){
clearInterval(timerInterval);
endGame();
}
},1000);
}

function endGame(){
clearInterval(timerInterval);
document.getElementById("game").classList.add("hidden");
document.getElementById("result").classList.remove("hidden");
document.getElementById("finalScore").innerText="Puntuaci√≥n: "+score;
}

function saveScore(){
let name=document.getElementById("playerName").value;
if(!name) return;
let ranking=JSON.parse(localStorage.getItem("ranking"))||[];
ranking.push({name,score});
ranking.sort((a,b)=>b.score-a.score);
ranking=ranking.slice(0,10);
localStorage.setItem("ranking",JSON.stringify(ranking));
backToMenu();
}

function showRanking(){
document.getElementById("menu").classList.add("hidden");
document.getElementById("ranking").classList.remove("hidden");
let ranking=JSON.parse(localStorage.getItem("ranking"))||[];
let list="";
ranking.forEach((r,i)=>{
list+= (i+1)+". "+r.name+" - "+r.score+"<br>";
});
document.getElementById("rankingList").innerHTML=list||"Sin puntuaciones a√∫n.";
}

function backToMenu(){
document.getElementById("menu").classList.remove("hidden");
document.getElementById("game").classList.add("hidden");
document.getElementById("result").classList.add("hidden");
document.getElementById("ranking").classList.add("hidden");
}

</script>
</body>
</html>
